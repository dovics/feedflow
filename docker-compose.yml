services:
  app:
    build:
      context: .
      dockerfile: Dockerfile
    container_name: feedwise-app
    ports:
      - "3000:3000"
      - "5432:5432"
    environment:
      # Database configuration
      # If DATABASE_URL is not set, embedded PostgreSQL will be started automatically
      # DATABASE_URL: postgresql://feedwise:feedwise@localhost:5432/feedwise?schema=public
      # Application configuration
      DEFAULT_ADMIN_PASSWORD: your-secret-key-change-this-in-production
      NODE_ENV: production
      # NextAuth configuration
      NEXTAUTH_URL: http://localhost:3000
      NEXTAUTH_SECRET: change-this-to-a-random-string-in-production
    volumes:
      # PostgreSQL data (only needed if DATABASE_URL is not set)
      - postgres-data:/var/lib/postgresql/data
    restart: unless-stopped

# Example configuration for external PostgreSQL database
# To use an external database, simply uncomment the DATABASE_URL line below:
#
#  app:
#    environment:
#      DATABASE_URL: postgresql://user:password@external-postgres-host:5432/feedwise?schema=public
#      # When DATABASE_URL is set, embedded PostgreSQL will not be started

volumes:
  postgres-data:
